---
description: パフォーマンス パネルを使用して、ユーザー操作中のページの応答性を分析する
title: DevTools - パフォーマンス
author: MSEdgeTeam
ms.author: msedgedevrel
ms.topic: article
ms.prod: microsoft-edge
keywords: microsoft edge, Web 開発, f12 ツール, devtools, パフォーマンス, プロファイル, フレーム レート, fps, CPU 使用率, JavaScript の実行
ms.custom: seodec18
ms.date: 11/19/2020
ROBOTS: NOINDEX,NOFOLLOW
ms.openlocfilehash: 561cfe62f7db492ce3914b4daba8ccf8c0a62a8a
ms.sourcegitcommit: a35a6b5bbc21b7df61d08cbc6b074b5325ad4fef
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/17/2020
ms.locfileid: "11234471"
---
# パフォーマンス

パフォーマンス **パネル** には、ユーザー操作中の UI の応答性をプロファイリングおよび分析するためのツールが用意されています。 この方法を使用すると、次の方法を行います。

 - [ページのさまざまなコンポーネント](#recording-a-profile) の実行時間を測定する 
 - [ページを実行するために最も多](#timeline-ruler) くの CPU サイクルを費やしている場所にドリルダウンし、結果としてユーザーに表示効果を与える
 - [ページの実行時間を消費するプロセスの詳細を](#timeline-details) ステップバイステップで取得する 
 - [レイアウトの再計算が必要な](#javascript-call-stacks) 操作など、コストのかかる操作を識別するために JavaScript の呼び出し履歴を確認する 

![DevTools パフォーマンス パネル](./media/performance.png)

## プロファイルの記録

ページのパフォーマンスを分析する最初の手順は、特定のユーザー シナリオを実行する際にプロファイルをキャプチャする手順です。たとえば、修正しようとしているパフォーマンス バグの再確認手順や、ユーザー エクスペリエンスを向上するために最適化する一般的な使用例です。 

### ツール バー

パフォーマンス トレース**を**  /  **開始**および終了するには、ツール バー (または) の [開始停止] `Ctrl+E` ボタンを使用します。 緑色のインジケーターが [パフォーマンス]**** タブに表示されます。記録が進行中です。 

![パフォーマンス パネルツール バー](./media/performance_toolbar.png)

プロファイルを停止すると、パフォーマンス レポートが生成されます。 後で DevTools でディスク ( ) に保存し、再読み込 `Ctrl+S` み ( `Ctrl+O` ) することができます。  DevTools 診断セッションは *、.diagsession 拡張機能と一緒に保存* されます。

プロファイルを記録する際に注意する必要があるいくつかのことを次に示します。

- 分析しようとしているシナリオをキャプチャするために必要な操作を最も少なくします。 ページに対する余分な操作により、余分なデータが生成され、結果が乱雑になります。

- プロファイラーは、ページ ナビゲーション [、DOMContentLoaded、](https://developer.mozilla.org/docs/Web/Events/DOMContentLoaded)ページ読み込みなど、レポート内の主要なアプリ ライフサイクル イベントを自動的にマーク [します](https://developer.mozilla.org/docs/Web/Events/load)。 カスタム マーカーを追加するには、コードまたはコンソール内から [Performance.mark()](https://developer.mozilla.org/docs/Web/API/Performance/mark) メソッドを呼び出します。 

- 初期ページの読み込み時間が分析に重要な場合は、(ネットワーク パネルから[](./network.md)) ブラウザーのキャッシュをクリアして、すべてのページ リソースがネットワークから読み込み中である必要があります。

- 場合によっては、複数のセッションを記録したり、異なるコンピューター間で同じシナリオをサンプルしたりして、パフォーマンスの問題を大自然に理解するのに役立つ場合があります。

## タイムライン ルーラー

タイムラインはスライド ルーラーとして機能します。 レポートの範囲を対象の特定の期間 (またはイベントの範囲) に制限するために使用します。 黒の **スライド** コントロールをドラッグして、調査する時間範囲を制限し、下部の [詳細] ウィンドウの [Timeline](#timeline-details) および [JavaScript](#javascript-call-stacks) コール スタック レポートから余分なプロファイリング データをフィルターで取り出 *します*。 

ルーラーには次の 2 種類のマーカーが表示されます。

 - **タイムライン上のアプリ** のライフサイクル マーク (ページ ナビゲーション [、DOMContentLoaded、](https://developer.mozilla.org/docs/Web/Events/DOMContentLoaded)ページ読み込 [みなど)](https://developer.mozilla.org/docs/Web/Events/load)は、プロファイルを記録すると自動的に記録されます。

 - **ユーザー マーク** は、コード内または DevTools コンソールから [Performance.mark()](https://developer.mozilla.org/docs/Web/API/Performance/mark) メソッドを呼び出して追加できるカスタム マーカー [**です**](./console.md)。 Performance.measure() メソッド*を使用**すると*、開始マークと終了マークを 1 つの名前付[きのメジャーとしてグループ化](https://developer.mozilla.org/docs/Web/API/Performance/measure)できます。 

時間範囲を選択した後は、ツールバーからさらに拡大表示するか、ズームと選択解除**** をリセットして**** パフォーマンス トレースの完全なビューに戻ります (時間範囲は選択されません)。 **** これらのコントロールは、右クリックのコンテキスト メニューから使用することもできます。

![パフォーマンス パネルのタイムライン](./media/performance_timeline.png)

### CPU 使用率

**CPU 使用率 % タイムライン**グラフは、ページの実行に必要なさまざまなブラウザー サブシステムによって消費される処理リソースを、カテゴリ別に示しています。

#### 読み込み中
アプリ リソースの取得と HTML と CSS の解析に費やした時間を示します。 これには、ネットワーク要求が含まれる場合があります。 タイムラインには、次の関連イベントが記録 [されます](#timeline-details)。

イベント | 説明
:------------ | :-------------
CssParsing  | 解析が必要な新しい CSS コンテンツが検出されました。
HtmlParsing | ノードに解析して DOM に挿入する必要がある新しい HTML コンテンツが検出されました。
HttpRequest | DOM でリモート リソースが検出されたか、HTTP 要求を行う必要がある XMLHttpRequest が作成されました。
HtmlSpeculativeDownloading | ページの HTML コンテンツは、HTTP 要求を可能な限り迅速にスケジュールするために必要なリソースを検索しています。


#### スクリプト
JavaScript の解析と実行に費やした時間を示します。 これには、DOM イベント、タイマー、スクリプト評価、およびアニメーション フレーム コールバックが含まれます。 タイムラインには、次の関連イベントが記録 [されます](#timeline-details)。

イベント | 説明
:------------ | :-------------
DomEvent | DOM オブジェクトでイベントが発生しました。
EvaluatingScript | DOM `<script>` で新しい要素が検出され、解析と実行が必要でした。
EventHandler | 登録されたイベント リスナーは、DOM イベントが発生した場合に応答してトリガーされました。
フレーム | 新しいフレームの準備中に、登録されたコールバックがトリガーされ、視覚的な変更が発生する可能性があります。
測定値 | アプリ固有のシナリオは、このメソッドを使用して測定 `performance.measure()` されました。
MediaQueryListener | 登録されたメディア クエリが無効にされ、関連付けられたリスナーが実行されました。
MutationObserver | 1 つ以上の確認済み DOM 要素が変更され、その結果、CallbackObserver に関連付けられたコールバックが実行されます。
TimerFired | スケジュールされたタイマーが経過し、関連付けられたコールバックが実行されました。
WindowsRuntimeAsyncCallback | 非同期操作は、コールバックをトリガーした Windows ランタイム オブジェクトによって完了 `Promise` しました。
WindowsRuntimeEvent | 登録されたリスナーをトリガーした Windows ランタイム オブジェクトでイベントが発生しました。

#### GC
使用されなくなったオブジェクトのメモリ収集に費やした時間を示します。 タイムラインには、次の関連イベントが記録 [されます](#timeline-details)。

イベント | 説明
:------------ | :-------------
ガベージ コレクション | JavaScript ランタイムは、参照されなくなったオブジェクトを特定するために、アプリの現在のメモリ使用量を監査しました。そのため、どのオブジェクトが収集される可能性があります。

#### スタイル設定
要素のプレゼンテーションとレイアウトの計算に費やした時間を示します。 タイムラインには、次の関連イベントが記録 [されます](#timeline-details)。

イベント | 説明
:------------ | :-------------
AlignedBeat | DOM に対して行われた保留中の視覚的な変更は、アプリの表示を更新するために処理されました。
CssCalculation | DOM に変更が加えられたか、新しい CSS コンテンツが追加され、影響を受けるすべての要素のスタイル プロパティを再計算する必要がありました。
レイアウト | DOM に変更が加え、影響を受けるすべての要素のサイズや位置を計算する必要がありました。

#### レンダリング
画面の塗り分けに費やした時間を示します。 タイムラインには、次の関連イベントが記録 [されます](#timeline-details)。

イベント | 説明
:------------ | :-------------
ペイント | DOM に対して視覚的な変更が行われたので、ページの影響を受けるすべての部分を再描画する必要がありました。
RenderLayer | DOM の個別にレンダリングされたフラグメント (レイヤーと呼ばれる) に対して視覚的な変更が行われたので、ページのそれぞれの部分を再描画する必要がありました。

#### 画像のデコード
イメージの解凍とデコードに費やした時間を示します。 タイムラインには、次の関連イベントが記録 [されます](#timeline-details)。

イベント | 説明
:------------ | :-------------
ImageDecoded | イメージは DOM に含まれており、元の形式からビットマップに解凍する必要がありました。

### 視覚的なスループット

ビジュアル **スループット (FPS)** グラフは、プロファイリング シナリオの過程で 1 秒あたりの推定 *フレーム数* (FPS) を示します。60 FPS が理想的な表示速度です。 フレーム レートのディップはパフォーマンスのボトルネックを示し、フレーム レートがゼロの場合はフレームが完全にドロップされます。

## タイムラインの詳細

最も下の詳細ウィンドウを使用して、ページで発生した内容の詳細を取得します。 [ **タイムラインの詳細]** タブには、さまざまなブラウザー サブシステム内で発生したイベントの詳細が表示されます。

![パフォーマンス タイムラインの詳細ウィンドウ](./media/performance_details_timeline.png)

1. **イベント リストの並べ替えコントロール**

    [並べ**替え]** ドロップダウン コントロールを使用して、[イベント リスト](#event-list)の順序を開始時刻と期間 (含む) の間***で切り替えてください*。 これにより、選択したタイムラインの詳細 [のビューも変更されます](#selected-timeline-details)。

2. **イベントをフレーム別にグループ化する**

    フレームトグル**** でグループ トップ レベル イベントを使用して、アニメーションやビジュアル更新が発生していた期間中に、トップ レベル イベント (HTML 解析、*レイアウト、DOM*イベントなど) を対応する作業単位 (または "フレーム") にグループ化します。 フレームは他のイベントと同様に扱われるので、並べ替え/フィルター処理を** 行い、イベント リストでクリックすると包括的な時刻の要約[を提供できます](#event-list)。

3. **イベント リスト フィルター コントロール**

    [Filter **events] メニューを使用** して、タイムラインの詳細に表示されるイベントの種類を [構成します](#timeline-details)。 

    ![パフォーマンス イベントをフィルター処理する制御](./media/performance_filter_events.png) 

    次のフィルターを使用できます。

   - **画像デコード**: バックグラウンド スレッドで発生したイベントを表示します (画像のデコード、GC など)。 
   - **ネットワーク トラフィック**: ネットワークにバインドされた HTTP 要求を表示します。
   - **UI アクティビティ**: UI スレッドやレンダリング スレッド (DOM イベント ハンドラー、レイアウトなど) で発生したイベントを表示します。
   - **ユーザーメジャー**: performance.measure() メソッドの呼び出しを示すカスタム イベントを表示します。

     さらに、包括的な期間でトップ レベルのイベントをフィルター処理できます。

### イベント リスト

イベント*リストには*、選択した期間中に発生した[](#cpu-utilization)ブラウザー サブシステム イベントの時系列リストが表示されます。 

任意のエントリをクリックして、そのアイテムの **[選択したイベントの詳細** ] グラフに値を設定します。 入れ子になったイベント/関数を含むエントリには、グラフに表示される包括的****な時間****(関数**とその関数が呼び出した他の関数の実行に費やされた時間) と排他時間 (呼び出し元関数自体の本体内でのみ費やされた時間) が表示されます。

任意のエントリを右クリックしてコンテキスト メニューを開き、タイムラインをそのイベントにのみフィルター処理し、イベントを担当するソース コードを[**デバッガー**](./debugger.md) [****](./elements.md) (該当する場合は [要素] パネル) に表示します。

### 選択したタイムラインの詳細

選択 *したタイムラインの詳細は* 、選択した期間中の包括的/排他的なイベント時間の詳細な棒グラフを提供します。 イベント リストの並べ替えコントロールを**** 使用して*期間 (* 含む) で並べ替える場合、最も長い実行中のイベントは、このグラフで視覚的に目立っています。 

### 選択したイベントの詳細

このレポートでは、選択したイベントに関する詳細情報を** 提供します。これには、開始時刻、実行中のスレッドの** 種類 (ダウンロード *、UI、**レンダリング*など)、特定のイベントの種類に固有のその他のコンテキスト詳細が含まれるものがあります。 たとえば、イベント リスナー *の種類は* 、コールバック関数とスケジュールの呼び出し履歴 *への* デバッガー *リンクを提供します*。

## JavaScript の呼び出し履歴

![JavaScript 呼び出しスタックのパフォーマンスのタイミング](./media/performance_details_javascript.png)

**[JavaScript コール スタック]** タブは、選択した時間範囲内で実行されたスクリプト関数の CPU 使用率情報とタイミングを提供します。

 列 | 説明
:------------ | :-------------
関数名 | ブラウザーまたはユーザー定義関数の名前。
包括 CPU (%) | この関数およびこの関数によって呼び出される関数で選択された CPU アクティビティの割合。
排他 CPU (%) | この関数で呼び出される関数のアクティビティを除く、この関数で選択された CPU アクティビティの割合。
包括 CPU (ミリ秒) | この関数およびこの関数によって呼び出される関数でのコードの実行に費やされた CPU 時間。
排他的 CPU (ミリ秒) | この関数で呼び出される関数の時間を除いて、この関数のコードの実行に費やされた CPU 時間。
URL | スタック フレームが発生した URL。 ブラウザー (標準ベースの Web API) から呼び出される関数呼び出しには *、[DOM] というラベルが付きます*。

## ショートカット

| 操作                         | ショートカット     |
|:-------------------------------|:-------------|
| プロファイリング セッションの開始/停止 | `Ctrl` + `E` |
| プロファイリング セッションのインポート       | `Ctrl` + `O` |
| プロファイリング セッションのエクスポート       | `Ctrl` + `S` |

## 既知の問題

### プロファイリング セッションの開始中にエラーが発生しました

このエラー メッセージが表示された **場合:** パフォーマンス ツールでプロファイリング セッションの開始中にエラーが発生した場合は、次の手順に従って回避策を確認してください。

1. を押 `Windows Key`  +  `R` します。

2. [ファイル名を指定して実行] ダイアログボックスに **、「services.msc」と入力します**。
![既知の問題-1](./media/known_issues_1.PNG)

3. Microsoft **(R) Diagnostics Hub Standard Collector Service** を見つけて右クリックします。
![既知の問題-2](./media/known_issues_2.PNG)

4. Microsoft **(R) Diagnostics Hub Standard Collector Service を再起動します**。
![既知の問題- 3](./media/known_issues_3.PNG)

5. Microsoft Edge 開発者ツールとタブを閉じます。新しいタブを開き、ページに移動して、押します `F12` 。

6. これで、プロファイリングを開始できます。
![既知の問題- 4](./media/known_issues_4-performance.PNG)

それでも問題が発生しますか? フィードバックの送信アイコンを使用して、フィードバック **をお送り** ください。 

![既知の問題- 5](./media/known_issues_5.PNG)

### プロファイリング セッションの停止中にエラーが発生しました。

このエラー メッセージが表示された **場合:** パフォーマンス ツールでプロファイリング セッションを停止中にエラーが発生した場合は、次の手順に従って回避策を確認してください。

1. を押 `Windows Key`  +  `R` します。

2. [ファイル名を指定して実行] ダイアログボックスに **、「services.msc」と入力します**。
![既知の問題-1](./media/known_issues_1.PNG)

3. Microsoft **(R) Diagnostics Hub Standard Collector Service** を見つけて右クリックします。
![既知の問題-2](./media/known_issues_2.PNG)

4. Microsoft **(R) Diagnostics Hub Standard Collector Service を再起動します**。
![既知の問題- 3](./media/known_issues_3.PNG)

5. Microsoft Edge 開発者ツールとタブを閉じます。新しいタブを開き、ページに移動して、押します `F12` 。

6. これで、プロファイリングを開始できます。
![既知の問題- 4](./media/known_issues_4-performance.PNG)

それでも問題が発生しますか? フィードバックの送信アイコンを使用して、フィードバック **をお送り** ください。 

![既知の問題- 5](./media/known_issues_5.PNG)
