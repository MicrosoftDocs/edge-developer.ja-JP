---
description: メモリ パネルを使用して
title: DevTools - メモリ
author: MSEdgeTeam
ms.author: msedgedevrel
ms.topic: article
ms.prod: microsoft-edge
keywords: microsoft edge, Web 開発, f12 ツール, devtools, メモリ, ヒープ, GC, ガベージ コレクション, 保持されたサイズ, ドミネータ
ms.custom: seodec18
ms.date: 11/19/2020
ROBOTS: NOINDEX,NOFOLLOW
ms.openlocfilehash: 5ad284f8072cc296743299ec9c4fb2037f8fd883
ms.sourcegitcommit: a35a6b5bbc21b7df61d08cbc6b074b5325ad4fef
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/17/2020
ms.locfileid: "11234452"
---
# メモリ

メモリ パネル **を使用** して、システム リソースの使用を測定し、さまざまな状態のコード実行でヒープ スナップショットを比較します。 この方法を使用すると、次の方法を行います。

- [ページのメモリ消費量をリアルタイムでグラフ化し](#memory-usage-timeline) 、ヒープのスナップショットを取得する
- [DOM に接続されていない保持](#snapshot-summary) オブジェクトなど、コード内の潜在的なメモリの問題を特定する
- [オブジェクトの種類、インスタンス](#snapshot-details) 数、サイズ、参照別にメモリ使用量データを確認し、問題を特定するのに役立ちます
- [スナップショット データ フィルターを適用](#filters) して操作できない情報のノイズを減らす
- [特定のオブジェクトのメモリ コストと](#object-references) 、それを維持する参照を特定する
- [調査の異なるフェーズで](#snapshot-comparison) ヒープを比較し、メモリ リークの原因や他の問題を追跡する

![Microsoft Edge DevTools メモリ パネル](./media/memory.png)


## ツール バー

1. **プロファイリング セッションの開始/停止 (Ctrl + E)**: プロファイラーを有効にすることで、メモリ使用量を追跡し、ヒープのスナップショットを取得できます。
2. **プロファイリング セッションのインポート (Ctrl + O)**: 保存された DevTools メモリ診断セッションを読み込む。
3. **プロファイリング セッションのエクスポート (Ctrl + S)**: 現在の診断セッションをディスクに保存します。
4. **ヒープ スナップショットを取得する (Ctrl + Shift + T)**: 特定の時点での現在のメモリ割り当てを記録します。


## メモリ使用量のタイムライン

メモリの問題は、パフォーマンスの問題の主要な原因となる可能性があります。その結果、ページの応答が低下し、時間の長い時間が続きます。

ページのメモリ使用量を分析する最初の手順は、ヒープの[](#toolbar)スナップショットの前/後にプロファイリング セッションを開始し、メモリが大きかったり、メモリ リークの疑いがあるステップを再生成したりします。

メモリ プロファイラーを起動すると、プロセス メモリ グラフが表示されます。これにより、プライベート ワーキング セット全体 (ページによって消費されるメモリの量) を時間の中で確認できます。 メモリ グラフには、プライベート バイト、ネイティブ メモリ、JavaScript ヒープを含むタブのプロセス メモリのライブ ビューが表示されます。 

![メモリ使用量のタイムライン](./media/memory_timeline.png)

 グラフには、ページのメモリ傾向が示されます。これにより、予期しないメモリ保持期間が発生した場合など[](#toolbar)、後で比較するためにヒープ スナップショットを取得する適切な時期を判断できます。

### Performance.mark()

コードまたは DevTools コンソールからメソッドを呼び出すことによって、分析セッションの過程で重要なイベントを識別するのに役立つカスタム ユーザー マークをタイムラインに**** [`Performance.mark()`](https://developer.mozilla.org/docs/Web/API/Performance/mark) 追加[**できます**](./console.md)。

### Console.takeheapSnapshot()

DOM の大規模な解析の直前など、非常に特定の時点でスナップショットを取得する必要がある場合があります。 このような場合は、プログラムでスナップショットを取得できます [`Console.takeHeapSnapshot()`](./console/console-api.md#taking-heap-snapshots) 。

## スナップショットの概要

[スナップショットを作成](#toolbar) すると、スナップショットが作成された時点での JavaScript ヒープのサイズと、割り当てられたオブジェクトの数とページのスクリーンショットを示す概要タイルが生成されます。 分析が必要なユーザー シナリオを実行すると、いつでもスナップショットを取得できます。 スナップショットは追加のタイルを生成し、それぞれのタイルは前のスナップショットからの JavaScript メモリの違いを示します。

![ヒープ スナップショット](./media/memory_snapshot.png)

概要タイルの値をクリックすると、スナップショット データの詳細を表示するウィンドウ [に切り替えます](#snapshot-details)。 潜在的 [なメモリの問題は、青色の](#snapshot-details) 情報 ("i") アイコンで示されます。

## スナップショットの詳細

[Snapshot] ウィンドウ *の* データには、ページによって作成されたオブジェクトと、使用している可能性のある JavaScript フレームワークによって割り当てられたメモリが表示されます。

![スナップショットの詳細の表](./media/memory_details.png)

3 つのタブは、データの異なるビューを表します。

#### 型

ヒープ上のオブジェクトのインスタンス数と合計サイズを、オブジェクトの種類別にグループ化して示します。 既定では、これらはインスタンス数で並べ替えされます。

上部の [種類] ウィンドウ** でオブジェクトを選択[](#object-references)すると、下枠の [オブジェクト参照] テーブルに、そのオブジェクトをポイントしているすべてのオブジェクトが一覧表示されます。

#### ルート

オブジェクトがグローバル オブジェクトにルート化され、ガベージ コレクションが実行されるのを防ぐ方法を説明する子参照の階層ビューを示します。

既定では、子ノードは保持されたサイズの列で並べ替えされ、最も大きいノードが一番上に表示されます。

#### ドミネータ

他のオブジェクトへの排他参照を持つヒープ上のオブジェクトの一覧を表示します。 リミネータは保持されたサイズで並べ替え、解放するのが最も簡単な可能性のあるメモリを消費するオブジェクトを示します。

型、ルート、およびドミネータ ビューの列を*解釈する方法**を次に示*します。

列 | 説明
:------------ | :-------------
識別子 | オブジェクトを最も識別する名前。 たとえば、HTML 要素の場合、スナップショットの詳細には ID 属性値 (使用されている場合) が表示されます。
型 | オブジェクトの種類 *(HTMLDivElement など*)。
Size | オブジェクト のサイズ 。参照されるオブジェクトのサイズは含め)。
保持サイズ | オブジェクト のサイズと、他の親を持たないすべての子オブジェクトのサイズ。 実際には、これはオブジェクトによって保持されるメモリの量です。したがって、オブジェクトを削除すると、指定したメモリ量を解放します。
Count | オブジェクト インスタンスの数。 この値は、[種類] ビューにのみ表示されます。

上部の [主ウィンドウ]** ウィンドウでオブジェクトを選択[](#object-references)すると、下枠の [オブジェクト参照] テーブルに、そのオブジェクトをポイントしているすべてのオブジェクトが一覧表示されます。

### フィルター

次の機能を使用して、表のデータをさらに調整できます。

![組み込みおよびオブジェクトの ID をフィルター処理する](./media/memory_filter.png)

1. **識別子フィルター**: 特定のオブジェクト識別子を検索してデータをフィルター処理する
2. **ドミネー**タによるグループ化**: 他のオブジェクトへの排他的な参照を持つオブジェクトだけが、オブジェクトのトップ レベル ビューに表示されます (これは *[デ*ミネータ] タブの既定のビューです)。
3. **組み込み/ID フィルター**: 既定では [、JavaScript](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects) の組み込みオブジェクトがリストに含まれています。 オブジェクトの一覧は、区別する必要がある匿名オブジェクトが複数ある場合に便利です。

種類 *ビュー、ルート* ビュー、および *ディ* ミネータ ビューにはそれぞれ独自のフィルターが設定されています。したがって、別のビューに切り替えてもフィルターは保持されません。

### オブジェクト参照

[型[**] ビューと [**](#types)[**管理**](#dominators)ウィンドウ] ビューの下枠には、共有参照を表示する**オブジェクト**参照リストが表示されます。 上部のウィンドウでオブジェクトを選択すると、そのオブジェクトをポイントしているすべてのオブジェクト (つまり、選択したオブジェクトを維持しているオブジェクト) が表示されます。

循環参照はアスタリスク (*) と情報ヒントと一緒に表示され、展開できません。 そうしないと、参照ツリーを上がってメモリを保持しているオブジェクトを識別する妨げになります。

同等のオブジェクトをすばやく識別するには、[表示オブジェクト [*ID]*](#filters) フィルター オプションをオンにし、[識別子] 列のオブジェクト名の横にオブジェクト ID *を表示* します。 同じ ID を持つオブジェクトは共有参照です。

### スナップショットの比較

[スナップショットの比較[] タブ](#snapshot-details)または [スナップショットの[](#snapshot-summary)概要] タイルの比較リンクをクリックすると、2 つのスナップショット間の情報の違いが表示されます。 比較ウィンドウでは、1 つのスナップショットに対** して表示されるのと[**](#snapshot-details)同じスナップショットの詳細が、*次*の追加の値で提供されます。

列 | 説明
:------------ | :-------------
サイズの違い。 | 現在のスナップショット内のオブジェクトのサイズと前のスナップショットのサイズの違い。参照されるオブジェクトのサイズは含め)。
保持サイズの差分。 | 現在のスナップショット内のオブジェクトの保持サイズと、前のスナップショットの保持サイズの違い。 保持されるサイズには、オブジェクト のサイズと、他の親を持たないすべての子オブジェクトのサイズが含まれます。 実際には、保持されるサイズはオブジェクトによって保持されるメモリの量です。したがって、オブジェクトを削除すると、指定したメモリ量を解放します。

[範囲] ドロップダウンを **使用** すると、スナップショット間の差分情報をフィルター処理できます。

![スナップショット比較用のスコープ フィルター](./media/memory_comparison_scope_filter.png)

- <strong>Snapshot # から残されたオブジェクト: ヒープに追加され、ヒープからベースライン スナップショットから以前のスナップショットに削除されたオブジェクトの違い <number></strong> を示します。 たとえば、スナップショットサマリーのオブジェクト数が <em> +205 / -195 の場合、このフィルターは追加されたが削除されていない 10 個のオブジェクト </em> を表示します。

- <strong>Snapshot # と # の間に追加されたオブジェクト: 前のスナップショットからヒープに追加 <number> <number></strong> されたオブジェクトすべてが表示されます。

- <strong>Snapshot # 内のすべてのオブジェクト: ヒープ上のすべてのオブジェクト (つまり、フィルター処理されていないビュー <number></strong> <em> ) を表示 </em> します。

既定では、" *一* 致しない参照の表示" フィルターは、現在の範囲フィルターと一致しないオブジェクト参照を示すために比較ビューに適用されます。 ドロップダウン メニューからオフにできます。

![スナップショット比較用の一致しない参照フィルター](./media/memory_comparison_matching_filter.png)


## ショートカット

 操作 | ショートカット
:------------ | :-------------
プロファイリング セッションの開始/停止  | `Ctrl` + `E`
プロファイリング セッションのインポート | `Ctrl` + `O`
プロファイリング セッションのエクスポート | `Ctrl` + `S`
ヒープ スナップショットを取得する | `Ctrl` + `Shift` + `T`

## 既知の問題

### プロファイリング セッションの開始中にエラーが発生しました

このエラー メッセージが表示された **場合:** メモリ ツールでプロファイリング セッションの開始中にエラーが発生した場合は、次の手順に従って回避策を確認してください。

1. を押 `Windows Key`  +  `R` します。

2. [ファイル名を指定して実行] ダイアログボックスに **、「services.msc」と入力します**。
![既知の問題-1](./media/known_issues_1.PNG)

3. Microsoft **(R) Diagnostics Hub Standard Collector Service** を見つけて右クリックします。
![既知の問題-2](./media/known_issues_2.PNG)

4. Microsoft **(R) Diagnostics Hub Standard Collector Service を再起動します**。
![既知の問題- 3](./media/known_issues_3.PNG)

5. Microsoft Edge 開発者ツールとタブを閉じます。新しいタブを開き、ページに移動して、押します `F12` 。

6. これで、プロファイリングを開始できます。 
![既知の問題- 4](./media/known_issues_4-memory.PNG)

それでも問題が発生しますか? フィードバックの送信アイコンを使用して、フィードバック **をお送り** ください。 

![既知の問題- 5](./media/known_issues_5.PNG)
