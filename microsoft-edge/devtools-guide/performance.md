---
description: '[パフォーマンス] パネルを使用して、ユーザーの操作中にページの responsivenes を分析する'
title: DevTools-パフォーマンス
author: MSEdgeTeam
ms.author: msedgedevrel
ms.date: 03/05/2020
ms.topic: article
ms.prod: microsoft-edge
keywords: microsoft edge、web 開発、f12 ツール、devtools、パフォーマンス、プロファイル、フレームレート、fps、CPU 使用率、JavaScript 実行
ms.custom: seodec18
ms.openlocfilehash: aecf3cf49592dbf1f24231e76f14ddc2ca1228c3
ms.sourcegitcommit: 6860234c25a8be863b7f29a54838e78e120dbb62
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/09/2020
ms.locfileid: "10569676"
---
# パフォーマンス

**パフォーマンス**パネルには、ユーザー操作の過程で UI の応答性をプロファイリングおよび分析するためのツールが用意されています。 これにより、次のことが可能になります。

 - ページのさまざまなコンポーネントの[実行時間の測定](#recording-a-profile) 
 - ページを実行するための CPU サイクルを最大限に活用し、ユーザーに対して視覚的な効果を得ら[れる場所までドリルダウン](#timeline-ruler)します。
 - [プロセスを使用するページ実行時間のステップバイステップの詳細を理解する](#timeline-details) 
 - [JavaScript の呼び出し履歴をウォーク](#javascript-call-stacks)して、レイアウトの再計算を必要とするものなど、コストの高い操作を特定します。 

![DevTools のパフォーマンスパネル](./media/performance.png)

## プロファイルの記録

ページのパフォーマンスを分析するための最初の手順は、特定のユーザーシナリオを実行するときにプロファイルをキャプチャすることです。たとえば、修正しようとしているパフォーマンスバグの再現手順や、ユーザーエクスペリエンスを向上させるために最適化する一般的なユースケースなどです。 

### ツール バー

**Start**  /  **Stop**ツールバーの [スタート] ボタン (または) を使って、 `Ctrl+E` パフォーマンス追跡を開始および終了します。 [**パフォーマンス**] タブに緑色のインジケーターが表示され、レコーディングが進行中であることを示します。 

![パフォーマンスパネルのツールバー](./media/performance_toolbar.png)

プロファイルを停止すると、パフォーマンスレポートが生成されます。 `Ctrl+S`後で DevTools で disk () と reload () に保存することを選択でき `Ctrl+O` ます。  DevTools 診断セッションは、 *diagsession*拡張子を付けて保存されます。

プロファイルを記録する場合は、次の点に注意してください。

- 分析しようとしているシナリオを捕捉するために必要な最小限のアクションを実行します。 このページで余分な操作を行うと、余分なデータが生成され、結果が乱雑になります。

- プロファイラーは、ページナビゲーション、 [Domcontentloaded](https://developer.mozilla.org/docs/Web/Events/DOMContentLoaded)、ページの[読み込み](https://developer.mozilla.org/docs/Web/Events/load)など、レポート内の主要なアプリのライフサイクルイベントを自動的にマークします。 カスタムマーカーを追加するには、コードまたは本体の中から[Performance. マーク ()](https://developer.mozilla.org/docs/Web/API/Performance/mark)メソッドを呼び出します。 

- 分析で最初のページ読み込み時間が重要な場合は、すべてのページリソースがネットワークから読み込まれるように、([ネットワーク](./network.md)パネルから) ブラウザキャッシュをクリアしてください。

- また、複数のセッションを記録したり、異なるマシン間で同じシナリオをサンプリングして、ワイルドカードによるパフォーマンスの問題について理解しやすくすることもできます。

## タイムラインルーラー

タイムラインは、スライディングルーラーとして動作します。 レポートの範囲を、関心のある特定の時間 (または一連のイベント) に制限する場合に使用します。 黒い**スライドコントロール**をドラッグして、調査する時間の範囲を制限し、低い [*詳細] ウィンドウ*の[タイムライン](#timeline-details)と[JavaScript の呼び出し履歴](#javascript-call-stacks)レポートから不要なプロファイリングデータをフィルター処理します。 

ルーラーには2種類のマーカーが表示されます。

 - タイムライン上の**アプリのライフサイクルマーク**(ページナビゲーション、 [domcontentloaded](https://developer.mozilla.org/docs/Web/Events/DOMContentLoaded)、ページ[読み込み](https://developer.mozilla.org/docs/Web/Events/load)など) は、プロファイルの記録時に自動的に記録されます。

 - **ユーザーマーク**はカスタムマーカーであり、コードまたは Devtools[**コンソール**](./console.md)内から[Performance. mark ()](https://developer.mozilla.org/docs/Web/API/Performance/mark)メソッドへの呼び出しを追加することを選択できます。 [Measure ()](https://developer.mozilla.org/docs/Web/API/Performance/measure)メソッドを使って、1つの名前付きメジャーとして、*開始*と*終了*のマークをまとめてグループ化できます。 

時間範囲を選択すると、ツールバーからさら**に拡大**することができます。または、[ズーム] と [**クリア**] を**リセット**すると、パフォーマンストレースの完全なビューに戻ります (時間範囲を選択していない場合)。 これらのコントロールは、右クリックのコンテキストメニューからも利用できます。

![パフォーマンスパネルのタイムライン](./media/performance_timeline.png)

### CPU 使用率

**CPU 使用率の%** タイムライングラフは、カテゴリ別に分類されてページを実行するために必要なさまざまなブラウザーサブシステムによって消費される処理リソースを示しています。

#### 読み込み中
アプリリソースの取得と HTML および CSS の解析に費やされた時間を示します。 これには、ネットワーク要求を含めることができます。 [タイムライン](#timeline-details)には、次の関連するイベントが記録されます。

イベント | 説明
:------------ | :-------------
Cssparc  | 解析する必要がある新しい CSS コンテンツが検出されました。
HtmlParsing 解析 | 新しい HTML コンテンツが検出されました。これには、ノードへの解析と DOM への挿入が必要です。
HttpRequest | DOM でリモートリソースが検出されたか、HTTP 要求を行う必要がある XMLHttpRequest が作成されました。
HtmlSpeculativeDownloading | ページの HTML コンテンツは、必要なリソースを検索しています。そのためには、HTTP 要求ができるだけ早くスケジュールされている可能性があります。


#### 作成
JavaScript の解析と実行に費やされた時間を示します。 これには、DOM イベント、タイマー、スクリプトの評価、アニメーションフレームのコールバックが含まれます。 [タイムライン](#timeline-details)には、次の関連するイベントが記録されます。

イベント | 説明
:------------ | :-------------
DomEvent | DOM オブジェクトでイベントが発生しました。
評価のスクリプト | `<script>`DOM で新しい要素が検出されたため、解析および実行が必要です。
EventHandler | 登録済みのイベントリスナーは、発生する DOM イベントに応じてトリガーされました。
フレーム | 新しいフレームが準備されている間、登録済みのコールバックがトリガーされ、視覚的な変更が発生する可能性があります。
測定値 | アプリ固有のシナリオは、このメソッドを使って測定されました `performance.measure()` 。
MediaQueryListener | 登録済みのメディアクエリが無効になりました。これにより、関連付けられたリスナーが実行されます。
ミューテーター | 1つまたは複数の DOM 要素が変更されたため、これによって、ミューテーターの関連付けられたコールバックが実行されました。
TimerFired | スケジュールされたタイマーが経過したため、関連付けられたコールバックが実行されました。
WindowsRuntimeAsyncCallback | 非同期操作は、コールバックをトリガーした Windows ランタイムオブジェクトによって実行されました `Promise` 。
WindowsRuntimeEvent | 登録済みリスナーをトリガーする Windows ランタイムオブジェクトでイベントが発生しました。

#### GC.COLLECT
使用されなくなったオブジェクトのメモリ収集に費やされた時間を示します。 [タイムライン](#timeline-details)には、次の関連するイベントが記録されます。

イベント | 説明
:------------ | :-------------
ガベージ コレクション | JavaScript ランタイムは、アプリの現在のメモリ使用量を監査したため、どのオブジェクトも参照されず、収集される可能性があります。

#### スタイル
要素のプレゼンテーションとレイアウトの計算に費やされた時間を示します。 [タイムライン](#timeline-details)には、次の関連するイベントが記録されます。

イベント | 説明
:------------ | :-------------
AlignedBeat | DOM に対して行われた保留中のビジュアル変更が処理され、アプリの表示が更新される可能性がありました。
Csん | DOM に変更が加えられたため、新しい CSS コンテンツが追加されました。影響を受けるすべての要素の style プロパティを再計算する必要があります。
レイアウト | DOM に変更が加えられました。これには、影響を受けるすべての要素のサイズや位置を計算する必要があります。

#### レンダリング
画面の描画に使われた時間を示します。 [タイムライン](#timeline-details)には、次の関連するイベントが記録されます。

イベント | 説明
:------------ | :-------------
ペイント | DOM に視覚的な変更が加えられました。これにより、ページの影響を受けるすべての部分を再描画する必要があります。
RenderLayer | 視覚的な変更は、DOM の (レイヤーと呼ばれる) DOM の独立したレンダリングフラグメントに対して行われ、ページの各部分を再描画する必要があります。

#### 画像のデコード
画像の展開とデコードに費やされた時間を示します。 [タイムライン](#timeline-details)には、次の関連するイベントが記録されます。

イベント | 説明
:------------ | :-------------
ImageDecoded | 画像は DOM に含まれていましたが、元の形式からビットマップに圧縮解除する必要があります。

### 視覚的なスループット

プロファイリングシナリオの過程で、[**ビジュアルスループット (fps)** ] グラフには、 *1 秒あたりの推定フレーム数*(fps) が表示されます。 60 FPS は最適な表示レートです。 フレームレートの dip は、パフォーマンスのボトルネックを示し、フレームレートが0であることを意味します。フレームは完全に削除されます。

## タイムラインの詳細

一番下詳細ウィンドウを使用して、ページ上で発生した問題の詳細をすべて表示します。 [**タイムラインの詳細**] タブには、さまざまなブラウザーサブシステム内で発生したイベントの内訳が表示されます。

![パフォーマンスタイムラインの詳細ウィンドウ](./media/performance_details_timeline.png)

1. **イベントリストの並べ替えコントロール**

    [**並べ替え**] ドロップダウンコントロールを使用して、[イベントの一覧](#event-list)の順序を*開始時刻*または*期間 (両端を含む*) で切り替えます。 これにより、[選択したタイムラインの詳細](#selected-timeline-details)のビューも変更されます。

2. **フレームごとにイベントをグループ化する**

    最上位レベルのイベントを [**フレームで**グループ化する] トグルを使って *、アニメーション*/ビジュアルの更新が行われている期間中の対応する作業単位 ("frame") にグループ化します。 フレームは、他のイベントと同じように扱われるため、[イベントリスト](#event-list)でクリックしたときに、表示される*時間*の概要を提供できます。

3. **イベントリストフィルターコントロール**

    [**イベントのフィルター** ] メニューを使って、[タイムラインの詳細](#timeline-details)に表示されるイベントの種類を構成します。 

    ![パフォーマンスイベントをフィルター処理するためのコントロール](./media/performance_filter_events.png) 

    次のフィルターを使用できます。

   - **画像のデコード**: バックグラウンドスレッドで発生したイベント (画像のデコード、GC など) を表示します。 
   - **ネットワークトラフィック**: ネットワークにバインドされていた HTTP 要求を表示します。
   - **Ui アクティビティ**: ui スレッドまたはレンダースレッド (DOM イベントハンドラー、レイアウトなど) で発生したイベントを表示します。
   - **ユーザー測定**: measure () メソッドの呼び出しを示すカスタムイベントを表示します。

     また、包括的な期間によって上位レベルのイベントをさらにフィルター処理することもできます。

### イベントリスト

*イベントリスト*には、選択した期間中に発生した[ブラウザーサブシステムイベント](#cpu-utilization)の時系列の一覧が表示されます。 

任意のエントリをクリックして、その項目の**選択したイベントの詳細**グラフにデータを入力します。 入れ子になったイベント/関数を含むエントリには、**包括**(関数の実行に費やされた関数*と*その他の関数の実行に費やされた時間) と**排他的**な値が表示されます (通話機能の本文内のみに費やされた時間)。

任意のエントリを右クリックしてコンテキストメニューを開き、そのイベントのみにタイムラインをフィルター処理し、[**デバッガー**](./debugger.md) (該当する場合は [[**要素**](./elements.md)] パネル) でイベントを担当するソースコードを表示します。

### 選択されたタイムラインの詳細

*選択したタイムラインの詳細*には、選択した期間中の包括/排他イベントの時間の詳細な棒グラフが用意されています。 **イベントリストの並べ替えコントロール**を使用して、*期間*で並べ替えると、最も長いイベントが視覚的に強調表示されます。 

### 選択されたイベントの詳細

このレポートは、選択したイベントに関する詳細情報を提供します。これには、*開始時刻*、実行中のスレッド型 (*ダウンロード*、 *UI*、*レンダリング*など)、および特定のイベントの種類に固有のその他のコンテキストの詳細が含まれます。 たとえば、*イベントリスナー*の型には、*コールバック関数*と*スケジューリングの呼び出しスタック*へのデバッガーリンクが用意されています。

## JavaScript の呼び出し履歴

![JavaScript の呼び出し履歴のパフォーマンスタイミング](./media/performance_details_javascript.png)

[ **JavaScript 呼び出しスタック**] タブには、選択した期間中に実行されたスクリプト関数の CPU 使用量に関する情報とタイミングが表示されます。

 列 | 説明
:------------ | :-------------
関数名 | ブラウザーまたはユーザー定義関数の名前。
包括的 CPU (%) | この関数およびこの関数によって呼び出される関数で選択された CPU アクティビティのパーセンテージ。
排他 CPU (%) | この関数で選択された CPU アクティビティのうち、この関数によって呼び出された関数のアクティビティを除いた割合。
包括的 CPU (ミリ秒) | この関数およびこの関数によって呼び出される関数でコードを実行するために消費された CPU 時間。
排他的 CPU (ミリ秒) | この関数でのコード実行に消費された CPU 時間。この関数によって呼び出された関数の時間は除外されます。
URL | スタックフレームが発生した URL。 ブラウザー (標準ベースの web Api) から発信された関数呼び出しは、 *[DOM]* というラベルが付いています。

## ショートカット

| 操作                         | キー     |
|:-------------------------------|:-------------|
| プロファイリングセッションの開始/停止 | `Ctrl` + `E` |
| プロファイルセッションのインポート       | `Ctrl` + `O` |
| プロファイリングセッションのエクスポート       | `Ctrl` + `S` |

## 既知の問題

### プロファイルセッションの開始中にエラーが発生しました

次のエラーメッセージが表示される場合は、パフォーマンスツールで**プロファイリングセッションの開始時にエラーが発生しまし**た。回避策については、次の手順を実行してください。

1. キーを押し `Windows Key`  +  `R` ます。

2. [実行] ダイアログボックスで、「 **services.msc**」と入力します。
![既知の問題-1](./media/known_issues_1.PNG)

3. **Microsoft (R) Diagnostics Hub Standard コレクタサービス**を探して右クリックします。
![既知の問題-2](./media/known_issues_2.PNG)

4. **Microsoft (R) Diagnostics Hub Standard コレクタサービス**を再起動します。
![既知の問題-3](./media/known_issues_3.PNG)

5. Microsoft Edge 開発者ツールとタブを閉じます。新しいタブを開き、目的のページに移動して、キーを押し `F12` ます。

6. これで、プロファイリングを開始できるようになります。
![既知の問題-4](./media/known_issues_4-performance.PNG)

まだ問題が発生していますか? フィードバックの**送信**アイコンを使ってフィードバックをお送りください。 

![既知の問題-5](./media/known_issues_5.PNG)

### プロファイリングセッションの停止中にエラーが発生しました。

このエラーメッセージが表示される場合: パフォーマンスツールで**プロファイリングセッションを停止しているときにエラーが発生**した場合は、次の手順に従って回避策を実行します。

1. キーを押し `Windows Key`  +  `R` ます。

2. [実行] ダイアログボックスで、「 **services.msc**」と入力します。
![既知の問題-1](./media/known_issues_1.PNG)

3. **Microsoft (R) Diagnostics Hub Standard コレクタサービス**を探して右クリックします。
![既知の問題-2](./media/known_issues_2.PNG)

4. **Microsoft (R) Diagnostics Hub Standard コレクタサービス**を再起動します。
![既知の問題-3](./media/known_issues_3.PNG)

5. Microsoft Edge 開発者ツールとタブを閉じます。新しいタブを開き、目的のページに移動して、キーを押し `F12` ます。

6. これで、プロファイリングを開始できるようになります。
![既知の問題-4](./media/known_issues_4-performance.PNG)

まだ問題が発生していますか? フィードバックの**送信**アイコンを使ってフィードバックをお送りください。 

![既知の問題-5](./media/known_issues_5.PNG)
