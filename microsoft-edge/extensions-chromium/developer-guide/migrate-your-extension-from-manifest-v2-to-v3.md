---
description: マニフェスト V2 から V3 への拡張機能の更新の詳細
title: マニフェスト V2 から V3 への拡張機能の更新の準備
author: MSEdgeTeam
ms.author: msedgedevrel
ms.date: 05/11/2020
ms.topic: article
ms.prod: microsoft-edge
keywords: edge-chromium, extensions development, edge extensions, browser extensions, addons, developer, manifest v3, migrate to manifest v3
ms.openlocfilehash: 5aa1aa7446a312d581bacc4fa19ba7362c6c2a3e
ms.sourcegitcommit: 7945939c29dfdd414020f8b05936f605fa2b640e
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/13/2021
ms.locfileid: "11564617"
---
# <a name="prepare-to-update-your-extensions-from-manifest-v2-to-v3"></a><span data-ttu-id="5a249-104">マニフェスト v2 から v3 に拡張機能を更新する準備をする</span><span class="sxs-lookup"><span data-stu-id="5a249-104">Prepare to update your extensions from Manifest v2 to v3</span></span>  

<span data-ttu-id="5a249-105">このドキュメントでは、マニフェスト v3 の一部として実装されている重要な変更点を示します。これは、Chromium拡張機能プラットフォームの次のバージョンです。</span><span class="sxs-lookup"><span data-stu-id="5a249-105">This document lists important changes being implemented as part of Manifest v3, which is the next version of the Chromium Extensions platform.</span></span>  <span data-ttu-id="5a249-106">拡張機能Microsoft Edge、実装の進行に合わせ、このドキュメントを更新します。</span><span class="sxs-lookup"><span data-stu-id="5a249-106">The Microsoft Edge extensions team updates this document as the implementation progresses.</span></span>  <span data-ttu-id="5a249-107">マニフェスト v3 への拡張機能の移行に関する詳細なガイダンスについては、「マニフェスト V3 への移行」 [に移動します][ChromeDeveloperDocsExtensionsMv3Mv3MigrationChecklist]。</span><span class="sxs-lookup"><span data-stu-id="5a249-107">For detailed guidance on migrating your extension to Manifest v3, navigate to [Migrating to Manifest V3][ChromeDeveloperDocsExtensionsMv3Mv3MigrationChecklist].</span></span>  

## <a name="remotely-hosted-code"></a><span data-ttu-id="5a249-108">リモートでホストされるコード</span><span class="sxs-lookup"><span data-stu-id="5a249-108">Remotely hosted code</span></span>  

<span data-ttu-id="5a249-109">現在、拡張機能コードの一部はリモートでホストされ、検証プロセス中に拡張機能パッケージの一部として含めることはできません。</span><span class="sxs-lookup"><span data-stu-id="5a249-109">Today, parts of the extensions code is hosted remotely, and not include it as part of the extension package during the validation process.</span></span>  <span data-ttu-id="5a249-110">これにより、拡張機能をストアに再送信せずにコードを柔軟に変更することができますが、インストール後にコードが悪用される可能性があります。</span><span class="sxs-lookup"><span data-stu-id="5a249-110">While this offers flexibility to change code without resubmitting the extension to the store, the code may be exploited after installation.</span></span>  <span data-ttu-id="5a249-111">アドオンが[Microsoft Edge検証][MicrosoftMicrosoftedgeAddons]済み拡張機能を一覧表示するために、Microsoft Edge 拡張機能チームは、リモートでホストされたコードを使用して拡張機能を禁止します。</span><span class="sxs-lookup"><span data-stu-id="5a249-111">To ensure [Microsoft Edge Add-ons][MicrosoftMicrosoftedgeAddons] lists validated extensions, the Microsoft Edge extensions team disallows extensions from using remotely hosted code.</span></span>  <span data-ttu-id="5a249-112">この変更により、拡張機能のセキュリティが高くなっています。</span><span class="sxs-lookup"><span data-stu-id="5a249-112">This change makes extensions more secure.</span></span>  <span data-ttu-id="5a249-113">開発者は、検証のために拡張機能で使用されるコードをパッケージ化して提出する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5a249-113">Developers will need to package and submit all code used by the extension for validation.</span></span>  <span data-ttu-id="5a249-114">または、サンドボックス環境で `eval()` 関数 [を使用できます][ChromeDeveloperDocsExtensionsMv2Sandboxingeval]。</span><span class="sxs-lookup"><span data-stu-id="5a249-114">Alternatively, you may use the `eval()` function in a [sandboxed environment][ChromeDeveloperDocsExtensionsMv2Sandboxingeval].</span></span>  

## <a name="run-time-host-permissions"></a><span data-ttu-id="5a249-115">実行時ホストのアクセス許可</span><span class="sxs-lookup"><span data-stu-id="5a249-115">Run-time host permissions</span></span>  

<span data-ttu-id="5a249-116">インストール時に、拡張機能がすべてのサイトとコンテンツにアクセスするための一括アクセス許可を要求する場合があります。</span><span class="sxs-lookup"><span data-stu-id="5a249-116">At installation time, extensions may request blanket permissions to access all sites and content.</span></span>  <span data-ttu-id="5a249-117">これらのアクセス許可により、拡張機能は最小限の介入で動作し、ユーザーのプライバシーとセキュリティに対するリスクを生み出します。</span><span class="sxs-lookup"><span data-stu-id="5a249-117">These permissions allow extensions to operate with minimum intervention, and create a risk to user privacy and security.</span></span>  <span data-ttu-id="5a249-118">透明性を向上させるために、Microsoft Edge拡張機能チームは、ユーザーが実行時に Web サイトへのアクセスを許可または制限するためのコントロールを提供します。</span><span class="sxs-lookup"><span data-stu-id="5a249-118">To improve transparency, the Microsoft Edge extensions team provides controls for users to allow or restrict access to websites at runtime.</span></span>  

## <a name="cross-origin-requests-in-content-scripts"></a><span data-ttu-id="5a249-119">コンテンツ スクリプトでのクロスオリジン要求</span><span class="sxs-lookup"><span data-stu-id="5a249-119">Cross-origin requests in content scripts</span></span>  

<span data-ttu-id="5a249-120">今日、コンテンツ スクリプトは、Web サイトで許可されていないオリジンを含む任意のオリジンへのアクセスを要求しています。</span><span class="sxs-lookup"><span data-stu-id="5a249-120">Today, content scripts request access to any origin including origins that aren't allowed by the website.</span></span>  <span data-ttu-id="5a249-121">この動作は、クロスオリジンの原則を壊します。</span><span class="sxs-lookup"><span data-stu-id="5a249-121">The behavior breaks cross-origin principles.</span></span>  <span data-ttu-id="5a249-122">今後、Microsoft Edge拡張機能チームは、コンテンツ スクリプトがスクリプトを挿入する Web ページと同じアクセス許可を持つ必要があります。セキュリティの抜け穴を閉じます。</span><span class="sxs-lookup"><span data-stu-id="5a249-122">Going forward, the Microsoft Edge extensions team requires content scripts to have the same permissions as the webpage into which the scripts are injected, closing a potential security loophole.</span></span>  <span data-ttu-id="5a249-123">クロスオリジン要求を実行するには、バックグラウンド スクリプトを使用して応答をコンテンツ スクリプトに中継する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5a249-123">To perform cross-origin requests, you need to use background scripts to relay responses back to content scripts.</span></span>  <span data-ttu-id="5a249-124">これらの変更は使用可能で、フラグの背後に表示されます。</span><span class="sxs-lookup"><span data-stu-id="5a249-124">These changes are available and behind a flag.</span></span>  <span data-ttu-id="5a249-125">詳細については、このドキュメントに移動 [します][ChromiumHomeChromiumSecurityExtensionContentScriptFetches]。</span><span class="sxs-lookup"><span data-stu-id="5a249-125">For more information, navigate to this [document][ChromiumHomeChromiumSecurityExtensionContentScriptFetches].</span></span>  

## <a name="web-request-api"></a><span data-ttu-id="5a249-126">Web 要求 API</span><span class="sxs-lookup"><span data-stu-id="5a249-126">Web Request API</span></span>  

<span data-ttu-id="5a249-127">拡張機能Microsoft Edgeチームは[、Web 要求 API][ChromeDeveloperDocsExtensionsReferenceWebrequest]を[Declarative Net Request API][ChromeDeveloperDocsExtensionsReferenceDeclarativenetrequest]に置き換えるが、Web 要求 API の観測機能を維持し続ける。</span><span class="sxs-lookup"><span data-stu-id="5a249-127">The Microsoft Edge extensions team replaces [Web Request API][ChromeDeveloperDocsExtensionsReferenceWebrequest] with [Declarative Net Request API][ChromeDeveloperDocsExtensionsReferenceDeclarativenetrequest], but continues to keep the observational capabilities of the Web Request API.</span></span>  <span data-ttu-id="5a249-128">拡張機能で Web 要求 API の観測機能が必要な特定のシナリオを除き、Microsoft Edge 拡張機能チームは DNR API のみを使用するようにお勧めします。</span><span class="sxs-lookup"><span data-stu-id="5a249-128">Except in some specific scenarios where observational capabilities of the Web Request API are required by the extension, the Microsoft Edge extensions team recommends using the DNR APIs only.</span></span>  <span data-ttu-id="5a249-129">拡張機能Microsoft Edgeチームは、この変更が機能豊富な宣言型機能を使用する拡張機能にプラスの影響を与える可能性を考えます。</span><span class="sxs-lookup"><span data-stu-id="5a249-129">The Microsoft Edge extensions team believes this change will have positive impact on extensions that use feature-rich declarative capabilities.</span></span>  <span data-ttu-id="5a249-130">より多くの拡張機能が DNR API に移行すると、この変更によりユーザーのプライバシーが向上し、拡張機能の使用に対する信頼が向上します。</span><span class="sxs-lookup"><span data-stu-id="5a249-130">As more extensions transition to the DNR APIs, this change will improve user privacy, which contributes to enhancing trust in the use of extensions.</span></span>  
<span data-ttu-id="5a249-131">企業は、エンタープライズ ポリシーによって管理される拡張機能に対して Web 要求 API のブロック動作を引き続き使用する場合があります。</span><span class="sxs-lookup"><span data-stu-id="5a249-131">Enterprises may continue to use the blocking behavior of the Web Request API for extensions managed through enterprise policies.</span></span>  <span data-ttu-id="5a249-132">拡張機能ポリシーの詳細については、「Microsoft Edge –[ポリシー」 に移動します][DeployedgeMicrosoftEdgePoliciesExtensions]。</span><span class="sxs-lookup"><span data-stu-id="5a249-132">For more information about extension policies, navigate to [Microsoft Edge – Policies][DeployedgeMicrosoftEdgePoliciesExtensions].</span></span>  

## <a name="background-service-workers"></a><span data-ttu-id="5a249-133">バックグラウンド サービスワーカー</span><span class="sxs-lookup"><span data-stu-id="5a249-133">Background service workers</span></span>  
 
<span data-ttu-id="5a249-134">サービス ワーカーは、Canary でテストできます。</span><span class="sxs-lookup"><span data-stu-id="5a249-134">Service workers are available for testing in Canary.</span></span>  <span data-ttu-id="5a249-135">拡張機能をバックグラウンド ページからサービス ワーカーに移行するには、「バックグラウンド ページからサービス ワーカーへの移行 [」を参照してください][ChromeDeveloperDocsExtensionsMv3MigratingToServiceWorkers]。</span><span class="sxs-lookup"><span data-stu-id="5a249-135">To migrate your extensions from background pages to service workers, refer to [Migrating from Background Pages to Service Workers][ChromeDeveloperDocsExtensionsMv3MigratingToServiceWorkers].</span></span>  <span data-ttu-id="5a249-136">拡張機能Microsoft Edgeチームは、この変更が開発者とユーザーの両方に与える影響を評価および調査しています。</span><span class="sxs-lookup"><span data-stu-id="5a249-136">The Microsoft Edge extensions team is evaluating and investigating the impact that this change brings to both developers and users.</span></span>  <span data-ttu-id="5a249-137">拡張機能Microsoft Edgeチームは、このドキュメントの変更に関する詳細を今後追加します。</span><span class="sxs-lookup"><span data-stu-id="5a249-137">The Microsoft Edge extensions team adds additional details on the change to this document in the future.</span></span>  

## <a name="when-are-these-changes-available-in-microsoft-edge"></a><span data-ttu-id="5a249-138">これらの変更が変更された場合は、Microsoft Edge</span><span class="sxs-lookup"><span data-stu-id="5a249-138">When are these changes available in Microsoft Edge</span></span>  

<span data-ttu-id="5a249-139">現在の宣言型ネット要求 API の実装は、Stable チャネルと Beta チャネルで利用できます。</span><span class="sxs-lookup"><span data-stu-id="5a249-139">The current declarative net request API implementation is available in our Stable and Beta channels.</span></span>  <span data-ttu-id="5a249-140">変更をテストし、フィードバックを提供します。</span><span class="sxs-lookup"><span data-stu-id="5a249-140">Test the changes, and provide feedback.</span></span>  <span data-ttu-id="5a249-141">拡張機能Microsoft Edgeは、開発の取り組みとさらなる変更の調査に貢献します。</span><span class="sxs-lookup"><span data-stu-id="5a249-141">The Microsoft Edge extensions team contributes to development efforts and investigate further changes.</span></span>  

| <span data-ttu-id="5a249-142">チャネル名</span><span class="sxs-lookup"><span data-stu-id="5a249-142">Channel name</span></span> | <span data-ttu-id="5a249-143">詳細</span><span class="sxs-lookup"><span data-stu-id="5a249-143">Details</span></span> |  
|:--- |:--- |  
| <span data-ttu-id="5a249-144">Microsoft Edge 84 Stable</span><span class="sxs-lookup"><span data-stu-id="5a249-144">Microsoft Edge 84 Stable</span></span> | <span data-ttu-id="5a249-145">DNR API はテストに使用できます</span><span class="sxs-lookup"><span data-stu-id="5a249-145">DNR API is available for testing</span></span> |  
| <span data-ttu-id="5a249-146">Microsoft Edge 85 Beta</span><span class="sxs-lookup"><span data-stu-id="5a249-146">Microsoft Edge 85 Beta</span></span> | <span data-ttu-id="5a249-147">ヘッダー変更のサポートが利用可能</span><span class="sxs-lookup"><span data-stu-id="5a249-147">Header modification support is available</span></span>|  

<span data-ttu-id="5a249-148">Chromium に変更が加わると、Microsoft Edge 拡張機能チームはタイムラインを共有し、コードを更新してストアに拡張機能を再発行できます。</span><span class="sxs-lookup"><span data-stu-id="5a249-148">When the changes are made to Chromium, the Microsoft Edge extensions team shares timelines so that you may update your code and republish extensions to the store.</span></span>  

<span data-ttu-id="5a249-149">拡張機能Microsoft Edgeチームは、ブログで更新プログラムの発行を続行します。</span><span class="sxs-lookup"><span data-stu-id="5a249-149">The Microsoft Edge extensions team continues publishing updates on the blog.</span></span>  <span data-ttu-id="5a249-150">変更に関するフィードバックは、Tech Community を[通じて提供できます][MicrosoftTechcommunityT5ArticlesManifestV3ChnagesAreNowAvailableInMicrosoftEdgeMP1780254]。</span><span class="sxs-lookup"><span data-stu-id="5a249-150">You may provide your feedback on the changes through [Tech Community][MicrosoftTechcommunityT5ArticlesManifestV3ChnagesAreNowAvailableInMicrosoftEdgeMP1780254].</span></span>

<!-- links -->  

[DeployedgeMicrosoftEdgePoliciesExtensions]: /deployedge/microsoft-edge-policies#extensions "拡張機能 - Microsoft Edge - ポリシー |Microsoft Docs"  

[MicrosoftMicrosoftedgeAddons]: https://microsoftedge.microsoft.com/addons "Microsoft Edge アドオン"  

[MicrosoftTechcommunityT5ArticlesManifestV3ChnagesAreNowAvailableInMicrosoftEdgeMP1780254]: https://techcommunity.microsoft.com/t5/articles/manifest-v3-changes-are-now-available-in-microsoft-edge/m-p/1780254 "マニフェスト V3 の変更は、次のMicrosoft Edge |Microsoft Tech Community"  

[ChromeDeveloperDocsExtensionsMv2Sandboxingeval]: https://developer.chrome.com/docs/extensions/mv2/sandboxingEval "Chrome 拡張機能で eval を使用|Chrome 開発者"  
[ChromeDeveloperDocsExtensionsMv3MigratingToServiceWorkers]:  https://developer.chrome.com/docs/extensions/mv3/migrating_to_service_workers "バックグラウンド ページからサービス ワーカーへの移行|Chrome 開発者"  
[ChromeDeveloperDocsExtensionsMv3Mv3MigrationChecklist]: https://developer.chrome.com/docs/extensions/mv3/mv3-migration-checklist "マニフェスト V3 移行チェックリスト |Chrome 開発者"    

[ChromeDeveloperDocsExtensionsReferenceDeclarativenetrequest]: https://developer.chrome.com/docs/extensions/reference/declarativeNetRequest "chrome.declarativeNetRequest |Chrome 開発者"  
[ChromeDeveloperDocsExtensionsReferenceWebrequest]: https://developer.chrome.com/docs/extensions/reference/webRequest "chrome.webRequest |Chrome 開発者"  

[ChromiumHomeChromiumSecurityExtensionContentScriptFetches]: https://www.chromium.org/Home/chromium-security/extension-content-script-fetches "Chrome 拡張機能コンテンツ スクリプトのクロスオリジン要求に対する変更点|The Chromium プロジェクト"  
